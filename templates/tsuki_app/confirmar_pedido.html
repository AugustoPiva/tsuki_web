{% extends "tsuki_app/base.html" %}
{% load my_extras %}

<!-- Aca se crea un pedido nuevo -->
{% block body_block %}

<!-- Cargar precios -->

{% for prod in lista %}
        <script type="text/javascript">
        listadoprecios.{{prod.id}} = [{{prod.precio_producto  }},"{{prod.nombre_producto}}"]
     </script>
{% endfor %}




<div class="jumbotron">

      <!-- Primera fila contiene la lista con los productos seleccionados, nombre fecha y comentarios -->
<form method="post">
  {% csrf_token %}


      <div class="row">
          <!--Primera columna -->
        <div class="col-6">
            <div class="row">
              <h6>Nombre cliente</h6>
            </div>
            <div class="row">
                {{form.nombre_cliente}}<br>
            </div>
            <div class="row">
              <h6>Comentario</h6>
              </div>
               <div class="row">
                {{ form.media }}
                {{form.comentario}}<br>
            </div>
            <div class="row">
                <div class="col-6">
                <div class="row">
                 <h6>Fecha</h6>
                  {{form.fecha}}
                </div>

                  <!-- Seccion boton confirmar pedido y modificar -->
                   <br><br><div class="row">
                        <input class = 'btn btn-primary' type="submit" value="Confirmar pedido">

                         <a style="margin-left:5px;" class = 'btn btn-warning' href="{% url 'tsuki_app:empezarpedido' %}"> Modificar </a>
                     </div>
                      </div>
                 <div class="col-6">
                 </div>
             </div>
        </div>

      <!-- Segunda columna -->
        <div class="col-6">
            <div id="carro" class="row">
                <table id="tabla-carro" class="table">
                  <thead>
                    <tr>
                      <th scope="col">Producto</th>
                      <th scope="col">Cantidad</th>
                      <th scope="col">Precio</th>
                    </tr>
                    </thead>
                  <tbody>
                    {% for producto in carro %}

                    <tr>
                      <td><p id ="{{producto}}" class = "N" ></p></td>
                   <td>{{carro|tomar_valor:producto}}</td>
                      <td><p id ="{{producto}}" class= "T" ></p> </td>

                    </tr>
                    <script type="text/javascript">

                    productospedidos.{{producto}} = {{carro|tomar_valor:producto}};

                 </script>
                 {% endfor %}
               </tbody>
             </table>
            </div>
            <div style="margin-top:10px;" class="row">
                <h6 id="totalcarrito">Total:</h6>
                <h6 id="total"></h6>
            </div>
           </div>
    </div>
</div>



<script type="text/javascript">

  for (var i in productospedidos){
      total = total + productospedidos[i]*listadoprecios[i][0];
      $('#'+i+'.N').text(''+listadoprecios[i][1]);
      $('#'+i+'.T').text('$ '+listadoprecios[i][0]*productospedidos[i]);

    };

var dateObj = new Date();
var month = dateObj.getUTCMonth() + 1; //months from 1-12
var day = dateObj.getUTCDate();
var year = dateObj.getUTCFullYear();

  $('#total').html(' $ '+ total);

 </script>
</form>
{% endblock %}
